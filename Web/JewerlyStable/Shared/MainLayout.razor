@inherits LayoutComponentBase
@inject NavigationManager NavMan
@inject ISnackbar Snackbar


<MudAppBar Color="Color.Primary" Fixed="false">

    <MudLink></MudLink>
    <MudAppBarSpacer />
    <MudButton Class="mx-2" OnClick="NavigateConf" Color="Color.Dark" Variant="Variant.Text" StartIcon="@Icons.Material.Filled.DesignServices">Конфигуратор изделий</MudButton>
    <MudAppBarSpacer />
    <AuthorizeView>
        <Authorized>
            <MudButton Class="mx-1" OnClick="@(()=> NavMan.NavigateTo("/order"))" Color="Color.Dark" Variant="Variant.Text" StartIcon="@Icons.Material.Filled.FormatListBulleted">Заказы</MudButton>
            <MudAppBarSpacer />
        </Authorized>
    </AuthorizeView>
    <MudButton Class="mx-1" Color="Color.Dark" Variant="Variant.Text" StartIcon="@Icons.Material.Filled.Info">О компании</MudButton>
    <MudAppBarSpacer />
    <AuthorizeView>
        <Authorized>
            <MudText Class="mx-2">Здраствуйте, @context.User.Identity.Name!</MudText>
            <MudButton Class="mx-2" OnClick="Navigate" Color="Color.Dark" Variant="Variant.Text">Личный кабинет</MudButton>
            <form method="post" action="Identity/Account/LogOut">
                <MudButton Class="mx-2" ButtonType="ButtonType.Submit" Variant="Variant.Text" Color="Color.Dark">Выйти</MudButton>
            </form>
        </Authorized>
        <NotAuthorized>
            <MudButton Class="mx-1" OnClick="@(()=> NavMan.NavigateTo("/Identity/Account/Login", true))" Color="Color.Dark" Variant="Variant.Text" StartIcon="@Icons.Material.Filled.Login">Личный кабинет</MudButton>
            <MudButton Class="mx-1" OnClick="@(()=> NavMan.NavigateTo("/Identity/Account/Register", true))" Color="Color.Dark" Variant="Variant.Text" StartIcon="@Icons.Material.Filled.HowToReg">Регистрация</MudButton>
        </NotAuthorized>
    </AuthorizeView>
    <MudAppBarSpacer />
    <MudLink></MudLink>
</MudAppBar>


<MudContainer Style="height: 700px; width:100%;">
    @Body
</MudContainer>
<footer class="footer-dark" style=" margin-top: 60px;
        padding: 50px 0;
        color: #f0f9ff;
        background-color: #424242;">
    <div class="container">
        <div class="row">
            <div class="col-sm-6 col-md-3 item">
                <h3>Сервисы</h3>
                <ul>
                    <li><a href="#">Web design</a></li>
                    <li><a href="#">Hosting</a></li>
                </ul>
            </div>
            <div class="col-sm-6 col-md-3 item">
                <h3>Информация</h3>
                <ul>
                    <li><a href="#">Company</a></li>
                    <li><a href="#">Team</a></li>
                    <li><a href="#">Careers</a></li>
                </ul>
            </div>
            <div class="col-md-6 item text">
                
                <p>Praesent sed lobortis mi. Suspendisse vel placerat ligula. Vivamus ac sem lacus. Ut vehicula rhoncus elementum. Etiam quis tristique lectus. Aliquam in arcu eget velit pulvinar dictum vel in justo.</p>
            </div>
            <div class="col item social"><a href="#"><i class="icon ion-social-snapchat"></i></a><a href="#"><i class="icon ion-social-instagram"></i></a></div>
        </div>
        <p class="copyright">Jewerly Workshop © 2021</p>
    </div>
</footer>




<MudThemeProvider Theme="MyCustomTheme" />
<MudDialogProvider />
<MudSnackbarProvider />



@code
{ 
    [CascadingParameter] Task<AuthenticationState> authenticationStateTask { get; set; }
    bool isAuthenticated;
    protected override async Task OnInitializedAsync()
    {
        var authState = await authenticationStateTask;
        var user = authState.User;
        isAuthenticated = user.Identity.IsAuthenticated;
    }
    MudTheme MyCustomTheme = new MudTheme()
    {
        Palette = new Palette()
        {
            Primary = Colors.Grey.Darken3,
            //Primary = Colors.Blue.Darken1,
            //Error = Colors.Blue.Darken1,
            Dark = Colors.Shades.White,
        },

        LayoutProperties = new LayoutProperties()
        {
            DrawerWidthLeft = "260px",
            DrawerWidthRight = "300px"
        }
    }; //цвета
    void Navigate()
    {
        NavMan.NavigateTo("/Identity/Account/Manage", forceLoad: true);
    }
    void NavOut()
    {
        NavMan.NavigateTo("/Identity/Account/LogOut");
    }
    void NavigateConf()
    {
        if (isAuthenticated) NavMan.NavigateTo("/configurator_page");
        else Snackbar.Add("Вы не авторизованы!", Severity.Error);
    }


}



@*<MudAppBar Color="Color.Success" Fixed="false">
        <NavLink class="nav-link" href="counter">
            <span class="oi oi-plus" aria-hidden="true"></span> Counter
        </NavLink>
        <MudLink Color="Color.Dark" Href="counter">Собрать изделие</MudLink>
        <MudAppBarSpacer />
        <MudLink Color="Color.Dark" Href="https://docs.microsoft.com/aspnet/">Мои заказы</MudLink>
        <MudAppBarSpacer />
        <MudLink Color="Color.Dark" Href="https://docs.microsoft.com/aspnet/">О компании</MudLink>
        <MudAppBarSpacer />
        <MudLink Color="Color.Dark" Href="https://docs.microsoft.com/aspnet/">Авторизация</MudLink>
    </MudAppBar>

    <MudContainer>
        @Body
    </MudContainer>*@


<!--
    <div class="page">
     <!--
     <div class="sidebar">
         <NavMenu />
     </div>

     -->
<!--
<div class="main">

    <!--<div class="top-row px-4">
        <a href="https://docs.microsoft.com/aspnet/" target="_blank">About</a>
    </div>

<div class="content px-4">
    @Body
    </div>
</div>
    </div>
   -->
